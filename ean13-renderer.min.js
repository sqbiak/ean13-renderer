/**
 * EAN-13 Barcode Renderer v1.0.0
 * @license Proprietary - All Rights Reserved
 * @author ZenBlock
 * (c) 2024 ZenBlock. Commercial use prohibited without license.
 * Contact: sebastian.qbiak+license@gmail.com
 */
!function(g,f){"object"==typeof exports&&"undefined"!=typeof module?module.exports=f():"function"==typeof define&&define.amd?define(f):g.EAN13Renderer=f()}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:this,function(){"use strict";const L=["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G=["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R=["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],S=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"];function checksum(c){let s=0;for(let i=0;i<12;i++)s+=parseInt(c[i])*(i%2===0?1:3);return(10-s%10)%10}function validate(c){c=String(c).replace(/\D/g,"");if(c.length===12)return!0;if(c.length===13)return parseInt(c[12])===checksum(c.substring(0,12));return!1}function encode(c){c=String(c).replace(/\D/g,"");if(c.length===12)c=c+checksum(c);if(c.length!==13)throw new Error("EAN-13 requires 12 or 13 digits");const f=parseInt(c[0]),st=S[f];let e="101";for(let i=0;i<6;i++){const d=parseInt(c[i+1]);e+=st[i]==="L"?L[d]:G[d]}e+="01010";for(let i=0;i<6;i++)e+=R[parseInt(c[i+7])];e+="101";return{encoding:e,fullCode:c}}const D={moduleWidth:2,height:70,guardExtend:10,fontSize:14,textMargin:2,quietZone:12,sideDigitGap:2,background:"#FFFFFF",foreground:"#000000",font:'"OCR-B","Courier New",monospace'};function render(cv,code,opts={}){if(typeof cv==="string")cv=document.querySelector(cv);if(!cv||!cv.getContext)throw new Error("Invalid canvas element");const o={...D,...opts},{moduleWidth:mw,height:h,guardExtend:ge,fontSize:fs,textMargin:tm,quietZone:qz,sideDigitGap:sg,background:bg,foreground:fg,font:ft}=o,{encoding:enc,fullCode:fc}=encode(code),bw=enc.length*mw,gh=h+ge,tw=bw+qz*2,th=gh+fs+tm;cv.width=tw;cv.height=th;const ctx=cv.getContext("2d");ctx.fillStyle=bg;ctx.fillRect(0,0,tw,th);ctx.fillStyle=fg;let x=qz;for(let i=0;i<enc.length;i++){const isG=i<3||i>=45&&i<50||i>=92,bh=isG?gh:h;if(enc[i]==="1")ctx.fillRect(x,0,mw,bh);x+=mw}ctx.fillStyle=fg;ctx.font=`${fs}px ${ft}`;ctx.textBaseline="top";const ty=h+tm;ctx.textAlign="right";ctx.fillText(fc[0],qz-sg,ty);ctx.textAlign="center";const ls=qz+3*mw;for(let i=0;i<6;i++)ctx.fillText(fc[i+1],ls+(i+.5)*7*mw,ty);const rs=qz+50*mw;for(let i=0;i<6;i++)ctx.fillText(fc[i+7],rs+(i+.5)*7*mw,ty);return cv}function toDataURL(c,o={}){const cv=document.createElement("canvas");render(cv,c,o);return cv.toDataURL("image/png")}function toBlob(c,o={}){return new Promise((res,rej)=>{const cv=document.createElement("canvas");render(cv,c,o);cv.toBlob(b=>b?res(b):rej(new Error("Failed to create blob")),"image/png")})}return{render,toDataURL,toBlob,encode,validate,calculateChecksum:checksum,version:"1.0.0",DEFAULTS:D}});
